#tag WindowBegin ContainerControl selectRaceControl   AcceptFocus     =   ""   AcceptTabs      =   True   AutoDeactivate  =   True   BackColor       =   &hFFFFFF   Backdrop        =   ""   Enabled         =   True   EraseBackground =   True   HasBackColor    =   False   Height          =   300   HelpTag         =   ""   InitialParent   =   ""   Left            =   ""   LockBottom      =   ""   LockLeft        =   ""   LockRight       =   ""   LockTop         =   ""   TabIndex        =   0   TabPanelIndex   =   0   TabStop         =   True   Top             =   ""   UseFocusRing    =   ""   Visible         =   True   Width           =   300   Begin Listbox RaceListBox      AutoDeactivate  =   True      AutoHideScrollbars=   True      Bold            =   ""      Border          =   True      ColumnCount     =   2      ColumnsResizable=   ""      ColumnWidths    =   "1*,4*"      DataField       =   ""      DataSource      =   ""      DefaultRowHeight=   -1      Enabled         =   True      EnableDrag      =   ""      EnableDragReorder=   ""      GridLinesHorizontal=   0      GridLinesVertical=   0      HasHeading      =   True      HeadingIndex    =   -1      Height          =   300      HelpTag         =   ""      Hierarchical    =   ""      Index           =   -2147483648      InitialParent   =   ""      InitialValue    =   "race_id	race_name"      Italic          =   ""      Left            =   0      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      RequiresSelection=   ""      Scope           =   0      ScrollbarHorizontal=   ""      ScrollBarVertical=   True      SelectionType   =   0      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   0      Underline       =   ""      UseFocusRing    =   True      Visible         =   True      Width           =   300      _ScrollWidth    =   -1   EndEnd#tag EndWindow#tag WindowCode	#tag Method, Flags = &h0		Sub Constructor(tempdb as REALSQLDatabase, multiSelect as boolean = false)		  initialize(tempdb,multiSelect)		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub initialize(tempdb as REALSQLDatabase, multiselect as Boolean = false)		  db = tempdb		  multi = multiSelect		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub PopulateRaceListBox()		  dim rs as RecordSet		  rs = db.SQLSelect("SELECT * FROM race_table")		  if db.Error then		    MsgBox "Error in PopulateRaceListBox(): "+G_Database.ErrorMessage		  else		    if rs<>nil then		      dim race_id, race_name as string		      		      RaceListBox.DeleteAllRows		      while not rs.EOF		        //Make sure this record is not hidden		        race_id = rs.Field("event_id").StringValue		        race_name = rs.Field("event_name").StringValue		        		        RaceListBox.AddRow race_id		        RaceListBox.cell(RaceListBox.ListCount-1,1)=race_name		        rs.MoveNext//move to next record~		      wend		    else		      MsgBox "No RecordSet Returned, so no Races Found."		    end if		  end if		  		  		  //Sort so the newest name is listed first		  If RaceListBox.ListCount > 0 then		    RaceListBox.ColumnSortDirection(0) = ListBox.SortDescending		    RaceListBox.SortedColumn=0		    RaceListBox.Sort		  end if		  		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Function rowsSelected() As Dictionary		  dim i as integer		  dim returnDic as new dictionary		  		  //Find which rows are selected		  for i = 1 to RaceListBox.ListCount		    		    if RaceListBox.Selected(i-1) = True then		      returnDic.Value(RaceListBox.Cell(i-1,0))=RaceListBox.Cell(i-1,1)		    end if		    		  next		  		  return returnDic		End Function	#tag EndMethod	#tag Property, Flags = &h0		db As REALSQLDatabase	#tag EndProperty	#tag Property, Flags = &h0		multi As Boolean = false	#tag EndProperty#tag EndWindowCode#tag Events RaceListBox	#tag Event		Function CellBackgroundPaint(g As Graphics, row As Integer, column As Integer) As Boolean		  if (row mod 2)=0 then		    g.foreColor = rgb(237,243,254)		    g.fillrect 0,0,g.Width,g.height		  end if		End Function	#tag EndEvent	#tag Event		Function CompareRows(row1 as Integer, row2 as Integer, column as Integer, ByRef result as Integer) As Boolean		  if cdbl(me.cell(row1,column)) > cdbl(me.cell(row2,column)) then		    result = 1		  else		    result = -1		  end if		  return true		End Function	#tag EndEvent#tag EndEvents