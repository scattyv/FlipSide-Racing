#tag WindowBegin ContainerControl selectRacersControl   AcceptFocus     =   ""   AcceptTabs      =   True   AutoDeactivate  =   True   BackColor       =   &hFFFFFF   Backdrop        =   ""   Enabled         =   True   EraseBackground =   True   HasBackColor    =   False   Height          =   400   HelpTag         =   ""   InitialParent   =   ""   Left            =   32   LockBottom      =   ""   LockLeft        =   ""   LockRight       =   ""   LockTop         =   ""   TabIndex        =   0   TabPanelIndex   =   0   TabStop         =   True   Top             =   32   UseFocusRing    =   ""   Visible         =   True   Width           =   768   Begin ListBox RacerListBox      AutoDeactivate  =   True      AutoHideScrollbars=   True      Bold            =   False      Border          =   True      ColumnCount     =   12      ColumnsResizable=   True      ColumnWidths    =   "0,1.5*,*,*,*,*,*,1.5*,64,*,32,54"      DataField       =   ""      DataSource      =   ""      DefaultRowHeight=   -1      Enabled         =   True      EnableDrag      =   ""      EnableDragReorder=   ""      GridLinesHorizontal=   1      GridLinesVertical=   2      HasHeading      =   True      HeadingIndex    =   -1      Height          =   400      HelpTag         =   ""      Hierarchical    =   False      Index           =   -2147483648      InitialParent   =   ""      InitialValue    =   "racer_id	#t_name	#t_class	#t_chassis	#t_make	#t_model	#t_motor	#t_UID	#t_crystal	#t_email	#t_color	#t_enabled"      Italic          =   ""      Left            =   0      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      RequiresSelection=   True      Scope           =   0      ScrollbarHorizontal=   False      ScrollBarVertical=   True      SelectionType   =   1      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   "#textsize12"      TextUnit        =   0      Top             =   0      Underline       =   ""      UseFocusRing    =   True      Visible         =   True      Width           =   768      _ScrollOffset   =   0      _ScrollWidth    =   -1   EndEnd#tag EndWindow#tag WindowCode	#tag Method, Flags = &h0		Sub Constructor(tempdb as REALSQLDatabase, tempPref as Preferences)		  initialize(tempdb, tempPref)		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub initialize(tempdb as REALSQLDatabase, tempPref as Preferences)		  db = tempdb		  pref = tempPref		  		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub PopulateRacerListBox()		  dim rs as RecordSet		  rs = db.SQLSelect("SELECT * FROM racer_table")		  if db.Error then		    MsgBox "Error in PopulateRacerListBox(): "+G_Database.ErrorMessage		  else		    if rs<>nil then		      dim racer_id,name,uid,scale,chassis,theClass,make,model,motor,crystal,email,textcolor as string		      dim enabled as boolean		      RacerListBox.DeleteAllRows		      while not rs.EOF		        //Make sure this record is not hidden		        if rs.Field("hidden").BooleanValue = False then		          racer_id = rs.Field("racer_id").StringValue		          name = rs.Field("name").StringValue		          uid = rs.Field("uid").StringValue		          scale = rs.Field("scale").StringValue		          chassis = rs.Field("chassis").StringValue		          theClass = rs.Field("class").StringValue		          make = rs.Field("make").StringValue		          model = rs.Field("model").StringValue		          motor = rs.Field("motor").StringValue		          crystal = rs.Field("crystal").StringValue		          email = rs.Field("email").StringValue		          textcolor = rs.Field("color").StringValue		          enabled = rs.Field("enabled").BooleanValue		          		          RacerListBox.AddRow racer_id		          RacerListBox.cell(RacerListBox.ListCount-1,1)=name		          RacerListBox.cell(RacerListBox.ListCount-1,2)=theClass		          RacerListBox.cell(RacerListBox.ListCount-1,3)=chassis		          RacerListBox.cell(RacerListBox.ListCount-1,4)=make		          RacerListBox.cell(RacerListBox.ListCount-1,5)=model		          RacerListBox.cell(RacerListBox.ListCount-1,6)=motor		          RacerListBox.cell(RacerListBox.ListCount-1,7)=uid		          RacerListBox.cell(RacerListBox.ListCount-1,8)=crystal		          RacerListBox.Cell(RacerListBox.ListCount-1,9)=email		          RacerListBox.Cell(RacerListBox.ListCount-1,10)=textcolor		          RacerListBox.CellCheck(RacerListBox.ListCount-1,11)=enabled		        end if		        rs.MoveNext//move to next record~		      wend		    else		      MsgBox "No RecordSet Returned, so no Racers Found."		    end if		  end if		  		  //If RacerListBox.ListCount > 0 then		  //RacerListBox.ColumnSortDirection(0) = ListBox.SortAscending		  //RacerListBox.SortedColumn=1		  //RacerListBox.Sort		  //end if		  		  //Sort based on the currently selected column		  RacerListBox.Sort		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Function rowsSelected() As Dictionary		  dim i as integer		  dim returnDic as new dictionary		  		  //Find which rows are selected		  for i = 1 to RacerListBox.ListCount		    		    if RacerListBox.Selected(i-1) = True then		      returnDic.Value(RacerListBox.Cell(i-1,0))=RacerListBox.Cell(i-1,1)		    end if		    		  next		  		  return returnDic		End Function	#tag EndMethod	#tag Property, Flags = &h0		db As REALSQLDatabase	#tag EndProperty	#tag Property, Flags = &h0		pref As Preferences	#tag EndProperty#tag EndWindowCode#tag Events RacerListBox	#tag Event		Sub Open()		  //First change the enabled column to a checkbox		  me.ColumnType(11) = 2		  		  		  //Set headings:		  me.heading(0) = "racer_id"		  me.heading(1) = t_name		  me.heading(2) = t_class		  me.heading(3) = t_chassis		  me.heading(4) = t_make		  me.heading(5) = t_model		  me.heading(6) = t_motor		  me.heading(7) = t_uid		  me.heading(8) = t_crystal		  me.heading(9) = t_email		  me.heading(10) = t_color		  me.heading(11) = t_enabled		  		  		  //PopulateRacerListBox()//this will update it on startup with correct info~		  		  //Sort by name when opened		  If RacerListBox.ListCount > 0 then		    RacerListBox.ColumnSortDirection(0) = ListBox.SortAscending		    RacerListBox.SortedColumn=1		    RacerListBox.Sort		  end if		End Sub	#tag EndEvent	#tag Event		Sub CellAction(row As Integer, column As Integer)		  //Check which column had action		  		  Select case column		    		  case 11		    //This is the checkbox column, we need to select that record, update the checkbox and then save		    		    me.ListIndex = row		    		  end select		End Sub	#tag EndEvent	#tag Event		Function CellBackgroundPaint(g As Graphics, row As Integer, column As Integer) As Boolean		  if (row mod 2)=0 then		    g.foreColor = rgb(237,243,254)		    g.fillrect 0,0,g.Width,g.height		  end if		  		  		  if column = 10 then		    if row <= me.LastIndex then		      		      if me.cell(row,column) <> "" then		        if pref.readS("editRacersColor") = "*" then		          g.ForeColor = GM_StringToColor(me.cell(row, column))		          		          g.fillrect 0,0,g.Width,g.height		        end if		        		      end if		      		    end if		    		  end if		End Function	#tag EndEvent	#tag Event		Function CellTextPaint(g As Graphics, row As Integer, column As Integer, x as Integer, y as Integer) As Boolean		  if column = 10 then		    if row <= me.LastIndex then		      		      if me.cell(row,column) <> "" then		        if pref.readS("editRacersColor") = "*" then		          g.ForeColor = GM_StringToColor(me.cell(row, column))		          		        end if		        		      end if		      		    end if		    		  end if		End Function	#tag EndEvent#tag EndEvents