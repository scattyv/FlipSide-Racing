#tag WindowBegin Window racersMakeWindow   BackColor       =   &hFFFFFF   Backdrop        =   ""   CloseButton     =   True   Composite       =   False   Frame           =   0   FullScreen      =   False   HasBackColor    =   False   Height          =   3.12e+2   ImplicitInstance=   True   LiveResize      =   True   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   False   MaxWidth        =   32000   MenuBar         =   ""   MenuBarVisible  =   True   MinHeight       =   64   MinimizeButton  =   True   MinWidth        =   64   Placement       =   0   Resizeable      =   False   Title           =   "#t_insertmakemodel"   Visible         =   True   Width           =   3.0e+2   Begin GroupBox GroupBox1      AutoDeactivate  =   True      Bold            =   ""      Caption         =   "#t_make"      Enabled         =   True      Height          =   103      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   20      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   ""      LockRight       =   ""      LockTop         =   ""      Scope           =   0      TabIndex        =   6      TabPanelIndex   =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   22      Underline       =   ""      Visible         =   True      Width           =   260      Begin TextField EditField_Make         AcceptTabs      =   ""         Alignment       =   0         AutoDeactivate  =   True         AutomaticallyCheckSpelling=   False         BackColor       =   &hFFFFFF         Bold            =   ""         Border          =   True         CueText         =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Format          =   ""         Height          =   22         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox1"         Italic          =   ""         Left            =   31         LimitText       =   0         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   ""         LockRight       =   ""         LockTop         =   ""         Mask            =   ""         Password        =   ""         ReadOnly        =   ""         Scope           =   0         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         Text            =   ""         TextColor       =   &h000000         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   46         Underline       =   ""         UseFocusRing    =   True         Visible         =   True         Width           =   80      End      Begin PushButton PushButton_InsertMake         AutoDeactivate  =   True         Bold            =   ""         ButtonStyle     =   0         Cancel          =   ""         Caption         =   "#t_insertmake"         Default         =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox1"         Italic          =   ""         Left            =   133         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   ""         LockRight       =   ""         LockTop         =   ""         Scope           =   0         TabIndex        =   1         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   46         Underline       =   ""         Visible         =   True         Width           =   121      End      Begin PopupMenu PopupMenu_DeleteMake         AutoDeactivate  =   True         Bold            =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox1"         InitialValue    =   ""         Italic          =   ""         Left            =   31         ListIndex       =   0         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Scope           =   0         TabIndex        =   2         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   83         Underline       =   ""         Visible         =   True         Width           =   80      End      Begin PushButton PushButton_DeleteMake         AutoDeactivate  =   True         Bold            =   ""         ButtonStyle     =   0         Cancel          =   ""         Caption         =   "#t_deletemake"         Default         =   ""         Enabled         =   True         Height          =   22         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox1"         Italic          =   ""         Left            =   133         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Scope           =   0         TabIndex        =   3         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   83         Underline       =   ""         Visible         =   True         Width           =   121      End   End   Begin GroupBox GroupBox2      AutoDeactivate  =   True      Bold            =   ""      Caption         =   "#t_model"      Enabled         =   True      Height          =   148      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   20      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   ""      LockRight       =   ""      LockTop         =   ""      Scope           =   0      TabIndex        =   7      TabPanelIndex   =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   144      Underline       =   ""      Visible         =   True      Width           =   260      Begin PopupMenu PopupMenu_Make         AutoDeactivate  =   True         Bold            =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox2"         InitialValue    =   ""         Italic          =   ""         Left            =   31         ListIndex       =   0         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   ""         LockRight       =   ""         LockTop         =   ""         Scope           =   0         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   177         Underline       =   ""         Visible         =   True         Width           =   80      End      Begin Label StaticText1         AutoDeactivate  =   True         Bold            =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox2"         Italic          =   ""         Left            =   133         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   ""         LockRight       =   ""         LockTop         =   ""         Multiline       =   ""         Scope           =   0         Selectable      =   False         TabIndex        =   1         TabPanelIndex   =   0         Text            =   "#t_selectmake"         TextAlign       =   0         TextColor       =   &h000000         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   177         Transparent     =   False         Underline       =   ""         Visible         =   True         Width           =   100      End      Begin TextField EditField_Model         AcceptTabs      =   ""         Alignment       =   0         AutoDeactivate  =   True         AutomaticallyCheckSpelling=   False         BackColor       =   &hFFFFFF         Bold            =   ""         Border          =   True         CueText         =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Format          =   ""         Height          =   22         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox2"         Italic          =   ""         Left            =   31         LimitText       =   0         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   ""         LockRight       =   ""         LockTop         =   ""         Mask            =   ""         Password        =   ""         ReadOnly        =   ""         Scope           =   0         TabIndex        =   2         TabPanelIndex   =   0         TabStop         =   True         Text            =   ""         TextColor       =   &h000000         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   217         Underline       =   ""         UseFocusRing    =   True         Visible         =   True         Width           =   80      End      Begin PushButton PushButton_InsertModel         AutoDeactivate  =   True         Bold            =   ""         ButtonStyle     =   0         Cancel          =   ""         Caption         =   "#t_insertmodel"         Default         =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox2"         Italic          =   ""         Left            =   133         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   ""         LockRight       =   ""         LockTop         =   ""         Scope           =   0         TabIndex        =   3         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   218         Underline       =   ""         Visible         =   True         Width           =   121      End      Begin PopupMenu PopupMenu_DeleteModel         AutoDeactivate  =   True         Bold            =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox2"         InitialValue    =   ""         Italic          =   ""         Left            =   31         ListIndex       =   0         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Scope           =   0         TabIndex        =   4         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   251         Underline       =   ""         Visible         =   True         Width           =   80      End      Begin PushButton PushButton_DeleteModel         AutoDeactivate  =   True         Bold            =   ""         ButtonStyle     =   0         Cancel          =   ""         Caption         =   "#t_deletemodel"         Default         =   ""         Enabled         =   True         Height          =   22         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox2"         Italic          =   ""         Left            =   133         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Scope           =   0         TabIndex        =   5         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   250         Underline       =   ""         Visible         =   True         Width           =   121      End   EndEnd#tag EndWindow#tag WindowCode	#tag Method, Flags = &h0		Sub rebuildMakePopup()		  dim rs as RecordSet		  		  PopupMenu_Make.DeleteAllRows		  PopupMenu_DeleteMake.DeleteAllRows		  mainWindow.makePopUpMenu.DeleteAllRows		  		  //PopupMenu_Make.AddRow "none"		  //PopupMenu_DeleteMake.AddRow "none"		  //mainWindow.makePopUpMenu.AddRow "none"		  		  rs = G_Database.SQLSelect("SELECT DISTINCT make FROM lu_make ORDER BY make")		  		  while rs.EOF = false		    PopupMenu_Make.AddRow rs.Field("make").StringValue		    PopupMenu_DeleteMake.AddRow rs.Field("make").StringValue		    mainWindow.makePopUpMenu.AddRow rs.Field("make").StringValue		    rs.MoveNext		  wend		  rs.close		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub rebuildModelPopup()		  dim rs as RecordSet		  dim i as Integer		  		  PopupMenu_DeleteModel.DeleteAllRows		  		  //PopupMenu_DeleteModel.AddRow "none"		  		  rs = G_Database.SQLSelect("SELECT make_id FROM lu_make WHERE make = '"+PopupMenu_Make.Text+"'")		  i = rs.Field("make_id").IntegerValue		  		  rs = G_Database.SQLSelect("SELECT * FROM lu_model WHERE fk_make_id = '"+str(i)+"'")		  		  if rs <> nil then		    while rs.EOF = false		      PopupMenu_DeleteModel.AddRow rs.Field("model").StringValue		      rs.MoveNext		    wend		    rs.Close		  end if		  		  PopupMenu_DeleteModel.ListIndex = 0		End Sub	#tag EndMethod	#tag Note, Name = LICENSE		Copyright 2008 Jeremy Auten				This file is part of Flip Side Racing Software.				Flip Side Racing Software is free software: you can redistribute it and/or modify		it under the terms of the GNU General Public License as published by		the Free Software Foundation, either version 3 of the License, or		(at your option) any later version.				Flip Side Racing Software is distributed in the hope that it will be useful,		but WITHOUT ANY WARRANTY; without even the implied warranty of		MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the		GNU General Public License for more details.				You should have received a copy of the GNU General Public License		along with Flip Side Racing Software.  If not, see <http://www.gnu.org/licenses/>.	#tag EndNote#tag EndWindowCode#tag Events EditField_Make	#tag Event		Function KeyDown(Key As String) As Boolean		  return instrb(G_allowedtext, key) = 0		End Function	#tag EndEvent#tag EndEvents#tag Events PushButton_InsertMake	#tag Event		Sub Action()		  dim query as string		  		  if lenb(EditField_Make.Text) > 0 then		    query = "INSERT INTO lu_make(make) VALUES ('"+EditField_Make.Text+"');"		    G_Database.SQLExecute(query)		    if G_Database.Error then		      MsgBox "Error inserting record, duplicate entry"		    else		      G_Database.Commit		    end if		    EditField_Make.Text=""		  end if		  		  rebuildMakePopup		  		  		End Sub	#tag EndEvent#tag EndEvents#tag Events PopupMenu_DeleteMake	#tag Event		Sub Open()		  dim rs as RecordSet		  		  		  me.DeleteAllRows		  //me.AddRow "none"		  		  rs = G_Database.SQLSelect("SELECT DISTINCT make FROM lu_make ORDER BY make")		  		  while rs.EOF = false		    me.AddRow rs.Field("make").StringValue		    rs.MoveNext		  wend		  rs.close		End Sub	#tag EndEvent#tag EndEvents#tag Events PushButton_DeleteMake	#tag Event		Sub Action()		  dim query as string		  dim rs as recordset		  dim i as integer		  		  if lenb(PopupMenu_DeleteMake.Text) > 0 and PopupMenu_DeleteMake.Text <> "none" then		    //we can delete this		    query = "DELETE FROM lu_make WHERE make == '"+PopupMenu_DeleteMake.Text+"'"		    G_Database.SQLExecute(query)		    if G_Database.Error then		      MsgBox "Error deleting make"		    end if		    		    //We must also delete any models as well		    rs = G_Database.SQLSelect("SELECT make_id FROM lu_make WHERE make = '"+PopupMenu_Make.Text+"'")		    i = rs.Field("make_id").IntegerValue		    		    query = "DELETE FROM lu_model WHERE fk_make_id = "+str(i)+";"		    G_Database.SQLExecute(query)		    if G_Database.Error then		      MsgBox "Error deleting make models"		    end if		    		    		    G_Database.Commit		    		    rebuildMakePopup		  end if		End Sub	#tag EndEvent#tag EndEvents#tag Events PopupMenu_Make	#tag Event		Sub Open()		  dim rs as RecordSet		  		  		  me.DeleteAllRows		  //me.AddRow "none"		  		  rs = G_Database.SQLSelect("SELECT DISTINCT make FROM lu_make ORDER BY make")		  		  while rs.EOF = false		    me.AddRow rs.Field("make").StringValue		    rs.MoveNext		  wend		  rs.close		  		  rebuildModelPopup		End Sub	#tag EndEvent	#tag Event		Sub GotFocus()		  dim rs as RecordSet		  		  		  me.DeleteAllRows		  //me.AddRow "none"		  		  rs = G_Database.SQLSelect("SELECT DISTINCT make FROM lu_make ORDER BY make")		  		  while rs.EOF = false		    me.AddRow rs.Field("make").StringValue		    rs.MoveNext		  wend		  rs.close		End Sub	#tag EndEvent	#tag Event		Sub Change()		  rebuildModelPopup		End Sub	#tag EndEvent#tag EndEvents#tag Events EditField_Model	#tag Event		Function KeyDown(Key As String) As Boolean		  return instrb(G_allowedtext, key) = 0		End Function	#tag EndEvent#tag EndEvents#tag Events PushButton_InsertModel	#tag Event		Sub Action()		  dim rs as RecordSet		  dim i as integer		  		  rs = G_Database.SQLSelect("SELECT make_id FROM lu_make WHERE make = '"+PopupMenu_Make.Text+"'")		  		  i = rs.Field("make_id").IntegerValue		  rs.close		  		  		  dim query as string		  		  if lenb(EditField_Model.Text) > 0 then		    query = "INSERT INTO lu_model(model, fk_make_id) VALUES ('"+EditField_Model.Text+"','"+str(i)+"');"		    G_Database.SQLExecute(query)		    if G_Database.Error then		      MsgBox "Error inserting record"		    else		      G_Database.Commit		    end if		    EditField_Model.Text=""		  end if		  		  rebuildModelPopup		End Sub	#tag EndEvent#tag EndEvents#tag Events PopupMenu_DeleteModel	#tag Event		Sub Open()		  rebuildModelPopup		End Sub	#tag EndEvent#tag EndEvents#tag Events PushButton_DeleteModel	#tag Event		Sub Action()		  dim query as string		  dim rs as recordset		  dim i as integer		  		  if lenb(PopupMenu_DeleteModel.Text) > 0 and PopupMenu_DeleteModel.Text <> "none" then		    //find the make id		    rs = G_Database.SQLSelect("SELECT make_id FROM lu_make WHERE make = '"+PopupMenu_Make.Text+"'")		    i = rs.Field("make_id").IntegerValue		    		    //Delete it		    query = "DELETE FROM lu_model WHERE fk_make_id = "+str(i)+" AND model = '"+PopupMenu_DeleteModel.Text+"';"		    G_Database.SQLExecute(query)		    if G_Database.Error then		      MsgBox "Error deleting model"		    end if		    G_Database.Commit		    		  end if		  		  		  		  		  		  		  rebuildModelPopup		  		  		  		End Sub	#tag EndEvent#tag EndEvents