#tag WindowBegin Window manageRaceProfiles   BackColor       =   &hFFFFFF   Backdrop        =   ""   CloseButton     =   True   Composite       =   False   Frame           =   0   FullScreen      =   False   HasBackColor    =   False   Height          =   120   ImplicitInstance=   True   LiveResize      =   True   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   False   MaxWidth        =   32000   MenuBar         =   ""   MenuBarVisible  =   True   MinHeight       =   64   MinimizeButton  =   True   MinWidth        =   64   Placement       =   0   Resizeable      =   False   Title           =   "#t_manageraceprofiles"   Visible         =   True   Width           =   300   Begin TextField EditField_Name      AcceptTabs      =   ""      Alignment       =   0      AutoDeactivate  =   True      AutomaticallyCheckSpelling=   False      BackColor       =   &hFFFFFF      Bold            =   ""      Border          =   True      CueText         =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Format          =   ""      Height          =   22      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   20      LimitText       =   0      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   ""      LockRight       =   ""      LockTop         =   ""      Mask            =   ""      Password        =   ""      ReadOnly        =   ""      Scope           =   0      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      Text            =   ""      TextColor       =   &h000000      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   46      Underline       =   ""      UseFocusRing    =   True      Visible         =   True      Width           =   260   End   Begin PushButton PushButton_OK      AutoDeactivate  =   True      Bold            =   ""      ButtonStyle     =   0      Cancel          =   ""      Caption         =   "#t_ok"      Default         =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   20      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   ""      LockRight       =   ""      LockTop         =   ""      Scope           =   0      TabIndex        =   1      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   80      Underline       =   ""      Visible         =   True      Width           =   80   End   Begin PushButton PushButton_Cancel      AutoDeactivate  =   True      Bold            =   ""      ButtonStyle     =   0      Cancel          =   ""      Caption         =   "#t_cancel"      Default         =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   200      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   ""      LockRight       =   ""      LockTop         =   ""      Scope           =   0      TabIndex        =   2      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   80      Underline       =   ""      Visible         =   True      Width           =   80   End   Begin Label StaticText_name      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   20      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   ""      LockRight       =   ""      LockTop         =   ""      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   3      TabPanelIndex   =   0      Text            =   "#t_enternewprofilename"      TextAlign       =   0      TextColor       =   &h000000      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   14      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   260   EndEnd#tag EndWindow#tag WindowCode#tag EndWindowCode#tag Events EditField_Name	#tag Event		Function KeyDown(Key As String) As Boolean		  Return instrb(G_allowedtext,key)=0		End Function	#tag EndEvent#tag EndEvents#tag Events PushButton_OK	#tag Event		Sub Action()		  dim success as Boolean		  		  		  if EditField_Name.Text <> "none" and EditField_Name.Text <> "None" and EditField_Name.Text <> "" then		    dim i as integer		    success = G_Preferences.theRaceObject.CreateProfile(G_Database, EditField_Name.Text)		    		    if success = true then		      //cheesy way to update the control		      mainWindow.PopupMenu_RC_profile.AddRow(EditField_Name.Text)		      		      		      for i = 0 to mainWindow.PopupMenu_RC_profile.ListCount -1		        if EditField_Name.Text = mainWindow.PopupMenu_RC_profile.List(i) then		          mainWindow.PopupMenu_RC_profile.ListIndex = i		        end if		        		      next		      		      self.Close		      		    else		      		      MsgBox "Error creating event, try a different name"		      		    end if		    		    		    		  end if		End Sub	#tag EndEvent#tag EndEvents#tag Events PushButton_Cancel	#tag Event		Sub Action()		  self.Close		End Sub	#tag EndEvent#tag EndEvents