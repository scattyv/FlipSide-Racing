#tag WindowBegin Window reassignRacerWindow   BackColor       =   &hFFFFFF   Backdrop        =   ""   CloseButton     =   True   Composite       =   True   Frame           =   0   FullScreen      =   False   HasBackColor    =   False   Height          =   5.92e+2   ImplicitInstance=   True   LiveResize      =   True   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   False   MaxWidth        =   32000   MenuBar         =   ""   MenuBarVisible  =   True   MinHeight       =   592   MinimizeButton  =   True   MinWidth        =   734   Placement       =   0   Resizeable      =   True   Title           =   "#t_racers"   Visible         =   True   Width           =   7.34e+2   Begin ListBox RacerListBox      AutoDeactivate  =   True      AutoHideScrollbars=   True      Bold            =   False      Border          =   True      ColumnCount     =   11      ColumnsResizable=   True      ColumnWidths    =   "0,1.5*,*,*,*,*,*,1.5*,64,*,54"      DataField       =   ""      DataSource      =   ""      DefaultRowHeight=   -1      Enabled         =   True      EnableDrag      =   ""      EnableDragReorder=   ""      GridLinesHorizontal=   1      GridLinesVertical=   2      HasHeading      =   True      HeadingIndex    =   -1      Height          =   500      HelpTag         =   ""      Hierarchical    =   False      Index           =   -2147483648      InitialParent   =   ""      InitialValue    =   "racer_id	#t_name	#t_class	#t_chassis	#t_make	#t_model	#t_motor	#t_uid	#t_crystal	#t_email	#t_enabled"      Italic          =   ""      Left            =   20      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      RequiresSelection=   True      Scope           =   0      ScrollbarHorizontal=   False      ScrollBarVertical=   True      SelectionType   =   0      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   "#textsize12"      TextUnit        =   0      Top             =   46      Underline       =   ""      UseFocusRing    =   True      Visible         =   True      Width           =   694      _ScrollOffset   =   0      _ScrollWidth    =   -1   End   Begin Label Label_Overview      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   20      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   2      TabPanelIndex   =   0      TabStop         =   True      Text            =   "#t_pleaseselectracertoreassignto"      TextAlign       =   0      TextColor       =   &h000000      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   14      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   694   End   Begin PushButton PushButton_OK      AutoDeactivate  =   True      Bold            =   ""      ButtonStyle     =   0      Cancel          =   ""      Caption         =   "#t_ok"      Default         =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   20      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   False      LockTop         =   False      Scope           =   0      TabIndex        =   3      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   558      Underline       =   ""      Visible         =   True      Width           =   80   End   Begin PushButton PushButton_Cancel      AutoDeactivate  =   True      Bold            =   ""      ButtonStyle     =   0      Cancel          =   ""      Caption         =   "#t_cancel"      Default         =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   634      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   False      Scope           =   0      TabIndex        =   4      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   558      Underline       =   ""      Visible         =   True      Width           =   80   EndEnd#tag EndWindow#tag WindowCode	#tag Method, Flags = &h1000		Sub Constructor(eventid as string, eventname as string, racerid as string, racername as string, formatstring as string)		  // Calling the overridden superclass constructor.		  Super.Constructor		  		  event_id = eventid		  racer_id = racerid		  event_name = eventname		  racer_name = racername		  		  RacerListBox.ColumnWidths = formatstring		  		  Label_Overview.Text = t_pleasereassignracerresults +" '" + racer_name + "' " + t_inrace + " '" + event_name + "' " + t_to		  		  //First change the enabled column to a checkbox		  RacerListBox.ColumnType(10) = 2		  		  PopulateRacerListBox()//this will update it on startup with correct info~		  		  //Sort by name when opened		  If RacerListBox.ListCount > 0 then		    RacerListBox.ColumnSortDirection(0) = ListBox.SortAscending		    RacerListBox.SortedColumn=1		    RacerListBox.Sort		  end if		End Sub	#tag EndMethod	#tag Method, Flags = &h21		Private Sub PopulateRacerListBox()		  dim rs as RecordSet		  		  rs = G_Database.SQLSelect("SELECT * FROM racer_table WHERE hidden == 0 AND racer_id NOT IN (SELECT racer_id FROM summary_table WHERE event_id == '" +event_id + "')")		  if G_Database.Error then		    MsgBox "Error in PopulateRacerListBox(): "+G_Database.ErrorMessage		  else		    if rs<>nil then		      dim racerid,name,uid,scale,chassis,theClass,make,model,motor,crystal,email as string		      dim enabled as boolean		      RacerListBox.DeleteAllRows		      while not rs.EOF		        racerid = rs.Field("racer_id").StringValue		        name = rs.Field("name").StringValue		        uid = rs.Field("uid").StringValue		        scale = rs.Field("scale").StringValue		        chassis = rs.Field("chassis").StringValue		        theClass = rs.Field("class").StringValue		        make = rs.Field("make").StringValue		        model = rs.Field("model").StringValue		        motor = rs.Field("motor").StringValue		        crystal = rs.Field("crystal").StringValue		        email = rs.Field("email").StringValue		        enabled = rs.Field("enabled").BooleanValue		        		        RacerListBox.AddRow racerid		        RacerListBox.cell(RacerListBox.ListCount-1,1)=name		        RacerListBox.cell(RacerListBox.ListCount-1,2)=theClass		        RacerListBox.cell(RacerListBox.ListCount-1,3)=chassis		        RacerListBox.cell(RacerListBox.ListCount-1,4)=make		        RacerListBox.cell(RacerListBox.ListCount-1,5)=model		        RacerListBox.cell(RacerListBox.ListCount-1,6)=motor		        RacerListBox.cell(RacerListBox.ListCount-1,7)=uid		        RacerListBox.cell(RacerListBox.ListCount-1,8)=crystal		        RacerListBox.Cell(RacerListBox.ListCount-1,9)=email		        RacerListBox.CellCheck(RacerListBox.ListCount-1,10)=enabled		        		        rs.MoveNext//move to next record~		      wend		    else		      MsgBox "No RecordSet Returned, so no Racers Found."		    end if		  end if		  		  RacerListBox.Sort		End Sub	#tag EndMethod	#tag Method, Flags = &h21		Private Sub reassignRacer()		  //Check to see if we have a racer selected		  dim status as boolean		  		  		  if RacerListBox.ListIndex = -1 then		    MsgBox t_pleaseselectracertoreassignto		    return		  end if		  		  if racer_id = "" or event_id = "" then		    MsgBox "Invalid racer id or event id"		    self.Close		  end if		  		  status = G_Preferences.theRaceObject.ReassignRacerResults(racer_id,RacerListBox.Cell(RacerListBox.ListIndex,0) ,event_id)		  		  if status = false then		    MsgBox "Failed to reassign the racer results"		    return		  else		    		    //Refresh the main window		    mainWindow.ShowRacerData(event_name)		    		    //Pop up a message saying we saved		    dim tempWindow as new messageWindow		    tempWindow.message = t_updated		    tempWindow.timeLimit = 1		    		    self.close		  end if		End Sub	#tag EndMethod	#tag Property, Flags = &h21		Private event_id As String	#tag EndProperty	#tag Property, Flags = &h21		Private event_name As String	#tag EndProperty	#tag Property, Flags = &h21		Private racer_id As String	#tag EndProperty	#tag Property, Flags = &h21		Private racer_name As String	#tag EndProperty#tag EndWindowCode#tag Events RacerListBox	#tag Event		Function CellBackgroundPaint(g As Graphics, row As Integer, column As Integer) As Boolean		  if (row mod 2)=0 then		    g.foreColor = rgb(237,243,254)		    g.fillrect 0,0,g.Width,g.height		  end if		End Function	#tag EndEvent	#tag Event		Sub Open()		  		  me.Heading(0) = "racer_id"		  me.Heading(1) = t_name		  me.Heading(2) = t_class		  me.Heading(3) = t_chassis		  me.Heading(4) = t_make		  me.Heading(5) = t_model		  me.Heading(6) = t_motor		  me.Heading(7) = t_uid		  me.Heading(8) = t_crystal		  me.Heading(9) = t_email		  me.Heading(10) = t_enabled		End Sub	#tag EndEvent#tag EndEvents#tag Events PushButton_OK	#tag Event		Sub Action()		  reassignRacer		End Sub	#tag EndEvent#tag EndEvents#tag Events PushButton_Cancel	#tag Event		Sub Action()		  self.Close		End Sub	#tag EndEvent#tag EndEvents